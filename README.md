**DANGEROUS: This tool is issuing commands as an extremely privledged root + context**

This tool issues root commands on 64bit Android 5.11 & Android 6.01 dirtycow vulnerable devices.
It does so with little verification. It will write whatever you tell it to write without
even blinking!! It's best to wait for those with more experience to lead the way...
**you been warned but sometimes we have to learn hard, if that's you pm me for help**
**but some failures can't be recovered**
------------------------------------------------------------------------------------------------
 True authors of this code are as follows
------------------------------------------------------------------------------------------------
###github.com names:
- timwr 		-- dirtycow exploit, nothing here would be possible without this first
- jcadduono 	-- Android genius, I feel like we all learn things from his code
- freddierice 	-- designed the process we expanded, thanks buddy

###Main coders:
- Delgoth 		-- Greyhat Rooting Project
- droidvoider 	-- Greyhat Rooting Project

------------------------------------------------------------------------------------------------
#Android dirtycow Greyhat Root Project -- Root Console
------------------------------------------------------------------------------------------------
This tool issues root commands on 64bit Android 6.01 dirtycow vulnerable devices. It
does so without verifying anything. It will write whatever you tell it to write without
even blinking!! My advice would be DON'T be a pioneer with my tools, ever!

This exploit gains root + install_recovery in one loop then root + system_server in the other.
Using a list of commands in a text file it will execute commands using those privledges.
It executes line by line in consecutive order and using identifiers it will execute the desired
command using one of the two available contexts.

If the exploit requires a file it needs to be copied to cache by another supporting process we
call bridge. bridge reads the same cmd_list.txt file to know what to copy, it ignores the
commands but instead reads the end copy commands.

We use two different methods to execute. The first method uses system() to execute the command.
If the system(command) fails we then process the command line for execv() and try again. In
some cases this is necessary, execv doesn't return and we currently do not test the status.
_________________________________________________________________________________________________


**BASIC INSTRUCTIONS:**
This tool uses a text file, 'cmd_list.txt', to determine what commands to issue along with which
supporting files to copy and where. I included an example cmd_list.txt used with an AT&T Note 5.
(root and at&t note 5 just went together in a sentence. im possible)

-yes, there is 2 intentional errors in cmd_list.txt to show the execv() attempt.
-note: install_recovery context most powerful when calling .sh script in /system/bin/

**See Makefile for basic process of how things work.**
1. Edit the cmd_list.txt file
1. create the following file ---> /data/local/tmp/cmd_list.txt
```
**Line Separators (spaces on command line only)**
**-$ == system_server** when first characters are -$ root+system_server executes line
**-# == install_recovery** when first characters are -# root+install_recovery executes
**|**<full path to binary> <options> <arg1> <arg2> <arg3> <arg4> <arg5>**|**
```
```
**example system server command:**
-$|pm disable com.ws.dm|
**example install recovery command:**
-#|/system/bin/sh /system/bin/install-recovery.sh| **dcow patch the .sh first!**
```
2. place any supporting files into ---> /data/local/tmp/
**Copy Line Separators** Copy lines must be at the end of "a" command line, inspecific which line
**~** <--- source ---> **~** <--- destination ---> **~**
**example system server WITH SUPPORTING FILES command**
```
-$|/system/bin/pm install /cache/recovery/Superuser.apk|~/data/local/tmp/Superuser.apk~/cache/recovery/Superuser.apk~
``
3. put farm, till, toolbox, bridge, cmd_list.txt and needed files into ---> /data/local/tmp/

4. open an extra terminal for logging. adb logcat | grep -a droid_dd_dcow

5. launch the binaries, example: adb shell /data/local/tmp/farm

6.
```
**new way**
Mess with power to dim screen, then power + vol buttons together.. (see notes at bottom it's much this way) 
**old way** 
Add and remove a screen lock pin. Wait between add/remove then do it again. Sometimes it happens fast, sometimes slow
(it will fire eventually see your log terminal to know.. trust me, you will get plenty of messages)
```


**LIST OF COMMANDS**

## Showing the status
```bash
make log
```

## Running tool for Android 6.01 64 bit r1 branch
First, you must edit cmd_list.txt and carefully confirm the commands are correct and as desired!
```bash
make run6
```

## Running tool for Android 5.11 64 bit r2 branch
First, you must edit cmd_list.txt and carefully confirm the commands are correct and as desired!
```bash
make run5
```

## Notes
If the log gets stuck here
```
farm-root: [*] waiting for process to finish
```
try to get system-server to run a toolbox command. (turning lockscreen on and off seems to work for galaxy s7 active and galaxy Note 5).

Updated for Note5: Playing with power + vol. up + vol. down makes the script fire!!!
```
Screen dim: power to undim, swipe unlock (no pin), now: power + vol. up, power + vol. down and then power to dim.. Now: power + vol. up to undim, power to dim
(keep messing with the buttons, dim/undim and it fires easily) -- no need to mess with screenlock for me **Android 6.01 Oct 2016 security**

## Notes from original creator
freddierice on github original concept. I have reworked it a lot.
his todo list ---> "* fix for armeabi? doesn't seem to work for this architecture right now."
not a bad idea....

## Help/Sources
* https://github.com/freddierice/farm-root for original code structure for this exploit
* https://github.com/timwr/CVE-2016-5195 for dirtycow exploit.
* https://github.com/jcadduono/android_external_dirtycow for some SELinux context ideas


<LOCALTEST> --- currently removed I may put this back later if we are having issues.
**LOCAL TEST WILL EXECUTE ALL COMMANDS THRUGH FARM.C FROM DIRECTORY /DATA/LOCAL/TMP**
1. Edit Android.mk
2. Add -D LOCALTEST to LOCAL_MODULE := farm like this --> LOCAL_CFLAGS    += -fPIE -DDEBUG -D LOCALTEST
See example file I renamed --> LOCALTEST-Android.mk
open 2 terminals, make log, make run



